<Window x:Class="OverlayApp.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:wv2="clr-namespace:Microsoft.Web.WebView2.Wpf;assembly=Microsoft.Web.WebView2.Wpf"
        mc:Ignorable="d"
        Title="Arc Raiders Overlay"
        Height="900"
        Width="1400"
        WindowStartupLocation="CenterScreen"
        WindowStyle="None"
        AllowsTransparency="True"
        ResizeMode="CanResize"
        ShowInTaskbar="False"
        Topmost="True"
        Background="Transparent"
        Loaded="OnWindowLoaded"
        SourceInitialized="OnSourceInitialized"
        Closing="OnWindowClosing"
        SizeChanged="OnWindowSizeChanged"
        LocationChanged="OnWindowLocationChanged"
        StateChanged="OnWindowStateChanged">
    <Window.Resources>
        <DropShadowEffect x:Key="OverlayShadow"
                          BlurRadius="18"
                          ShadowDepth="0"
                          Color="#66000000" />
    </Window.Resources>

    <Grid>
        <Border x:Name="ChromeBorder"
                Margin="12"
                CornerRadius="20"
                Background="#10000000"
                BorderBrush="#30FFFFFF"
                BorderThickness="1"
                Effect="{StaticResource OverlayShadow}">
            <Grid Margin="0" Background="Transparent">
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto" />
                <RowDefinition Height="*" />
            </Grid.RowDefinitions>

                <Border x:Name="HeaderBar"
                    Grid.Row="0"
                    Background="#66000000"
                    Padding="14"
                    CornerRadius="20,20,0,0"
                    MouseLeftButtonDown="OnHeaderMouseDown">
                <DockPanel>
                    <TextBlock DockPanel.Dock="Left"
                               Text="ArcTracker Overlay"
                               VerticalAlignment="Center"
                               FontSize="18"
                               FontWeight="Bold"
                               Foreground="#F0FFFFFF" />

                        <Button x:Name="HeaderMenuButton"
                            DockPanel.Dock="Right"
                            Padding="8"
                            Width="44"
                            Height="44"
                            Background="#22000000"
                            BorderBrush="#55FFFFFF"
                            BorderThickness="1"
                            ToolTip="Overlay menu"
                            Click="OnHeaderMenuRequested">
                        <Button.Template>
                            <ControlTemplate TargetType="Button">
                                <Border x:Name="MenuBorder"
                                        CornerRadius="20"
                                        Background="{TemplateBinding Background}"
                                        BorderBrush="{TemplateBinding BorderBrush}"
                                        BorderThickness="{TemplateBinding BorderThickness}">
                                    <Grid>
                                        <Rectangle Fill="#30FFFFFF" RadiusX="20" RadiusY="20" />
                                        <StackPanel VerticalAlignment="Center">
                                            <Rectangle Height="2" Width="18" Fill="#F0FFFFFF" RadiusX="2" RadiusY="2" Margin="0,0,0,4" />
                                            <Rectangle Height="2" Width="18" Fill="#F0FFFFFF" RadiusX="2" RadiusY="2" Margin="0,0,0,4" />
                                            <Rectangle Height="2" Width="18" Fill="#F0FFFFFF" RadiusX="2" RadiusY="2" />
                                        </StackPanel>
                                    </Grid>
                                </Border>
                                <ControlTemplate.Triggers>
                                    <Trigger Property="IsMouseOver" Value="True">
                                        <Setter TargetName="MenuBorder" Property="Background" Value="#44000000" />
                                        <Setter TargetName="MenuBorder" Property="BorderBrush" Value="#88FFFFFF" />
                                    </Trigger>
                                    <Trigger Property="IsPressed" Value="True">
                                        <Setter TargetName="MenuBorder" Property="Background" Value="#66000000" />
                                        <Setter TargetName="MenuBorder" Property="BorderBrush" Value="#CCFFFFFF" />
                                    </Trigger>
                                </ControlTemplate.Triggers>
                            </ControlTemplate>
                        </Button.Template>
                        <Button.ContextMenu>
                            <ContextMenu x:Name="HeaderContextMenu">
                                <MenuItem Header="Reload"
                                          Click="OnReloadRequested" />
                                <MenuItem x:Name="MenuClickThroughToggle"
                                          Header="Click-through"
                                          IsCheckable="True"
                                          Click="OnClickThroughMenuItemClicked" />
                                <Separator />
                                <MenuItem Header="Settings"
                                          Click="OnSettingsRequested" />
                                <MenuItem Header="Close"
                                          Click="OnCloseRequested" />
                            </ContextMenu>
                        </Button.ContextMenu>
                    </Button>
                </DockPanel>
            </Border>

            <wv2:WebView2 x:Name="OverlayView"
                          Grid.Row="1"
                          DefaultBackgroundColor="Transparent"
                          HorizontalAlignment="Stretch"
                          VerticalAlignment="Stretch"
                          IsHitTestVisible="True" />
            </Grid>
        </Border>
    </Grid>
</Window>
